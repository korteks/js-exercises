!function(a){function b(a,b,e){return 4===arguments.length?c.apply(this,arguments):void d(a,{declarative:!0,deps:b,declare:e})}function c(a,b,c,e){d(a,{declarative:!1,deps:b,executingRequire:c,execute:e})}function d(a,b){b.name=a,a in n||(n[a]=b),b.normalizedDeps=b.deps}function e(a,b){if(b[a.groupIndex]=b[a.groupIndex]||[],-1==o.call(b[a.groupIndex],a)){b[a.groupIndex].push(a);for(var c=0,d=a.normalizedDeps.length;d>c;c++){var f=a.normalizedDeps[c],g=n[f];if(g&&!g.evaluated){var h=a.groupIndex+(g.declarative!=a.declarative);if(void 0===g.groupIndex||g.groupIndex<h){if(void 0!==g.groupIndex&&(b[g.groupIndex].splice(o.call(b[g.groupIndex],g),1),0==b[g.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");g.groupIndex=h}e(g,b)}}}}function f(a){var b=n[a];b.groupIndex=0;var c=[];e(b,c);for(var d=!!b.declarative==c.length%2,f=c.length-1;f>=0;f--){for(var g=c[f],i=0;i<g.length;i++){var k=g[i];d?h(k):j(k)}d=!d}}function g(a){return s[a]||(s[a]={name:a,dependencies:[],exports:{},importers:[]})}function h(b){if(!b.module){var c=b.module=g(b.name),d=b.module.exports,e=b.declare.call(a,function(a,b){if(c.locked=!0,"object"==typeof a)for(var e in a)d[e]=a[e];else d[a]=b;for(var f=0,g=c.importers.length;g>f;f++){var h=c.importers[f];if(!h.locked)for(var i=0;i<h.dependencies.length;++i)h.dependencies[i]===c&&h.setters[i](d)}return c.locked=!1,b},b.name);c.setters=e.setters,c.execute=e.execute;for(var f=0,i=b.normalizedDeps.length;i>f;f++){var j,k=b.normalizedDeps[f],l=n[k],o=s[k];o?j=o.exports:l&&!l.declarative?j=l.esModule:l?(h(l),o=l.module,j=o.exports):j=m(k),o&&o.importers?(o.importers.push(c),c.dependencies.push(o)):c.dependencies.push(null),c.setters[f]&&c.setters[f](j)}}}function i(a){var b,c=n[a];if(c)c.declarative?l(a,[]):c.evaluated||j(c),b=c.module.exports;else if(b=m(a),!b)throw new Error("Unable to load dependency "+a+".");return(!c||c.declarative)&&b&&b.__useDefault?b["default"]:b}function j(b){if(!b.module){var c={},d=b.module={exports:c,id:b.name};if(!b.executingRequire)for(var e=0,f=b.normalizedDeps.length;f>e;e++){var g=b.normalizedDeps[e],h=n[g];h&&j(h)}b.evaluated=!0;var l=b.execute.call(a,function(a){for(var c=0,d=b.deps.length;d>c;c++)if(b.deps[c]==a)return i(b.normalizedDeps[c]);throw new TypeError("Module "+a+" not declared as a dependency.")},c,d);l&&(d.exports=l),c=d.exports,c&&c.__esModule?b.esModule=c:b.esModule=k(c)}}function k(b){if(b===a)return b;var c={};if("object"==typeof b||"function"==typeof b)if(p){var d;for(var e in b)(d=Object.getOwnPropertyDescriptor(b,e))&&r(c,e,d)}else{var f=b&&b.hasOwnProperty;for(var e in b)(!f||b.hasOwnProperty(e))&&(c[e]=b[e])}return c["default"]=b,r(c,"__useDefault",{value:!0}),c}function l(b,c){var d=n[b];if(d&&!d.evaluated&&d.declarative){c.push(b);for(var e=0,f=d.normalizedDeps.length;f>e;e++){var g=d.normalizedDeps[e];-1==o.call(c,g)&&(n[g]?l(g,c):m(g))}d.evaluated||(d.evaluated=!0,d.module.execute.call(a))}}function m(a){if(u[a])return u[a];if("@node/"==a.substr(0,6))return t(a.substr(6));var b=n[a];if(!b)throw"Module "+a+" not present.";return f(a),l(a,[]),n[a]=void 0,b.declarative&&r(b.module.exports,"__esModule",{value:!0}),u[a]=b.declarative?b.module.exports:b.esModule}var n={},o=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},p=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(q){p=!1}var r;!function(){try{Object.defineProperty({},"a",{})&&(r=Object.defineProperty)}catch(a){r=function(a,b,c){try{a[b]=c.value||c.get.call(a)}catch(d){}}}}();var s={},t="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,u={"@empty":{}};return function(a,d,e){return function(f){f(function(f){for(var g={_nodeRequire:t,register:b,registerDynamic:c,get:m,set:function(a,b){u[a]=b},newModule:function(a){return a}},h=0;h<d.length;h++)(function(a,b){b&&b.__esModule?u[a]=b:u[a]=k(b)})(d[h],arguments[h]);e(g);var i=m(a[0]);if(a.length>1)for(var h=1;h<a.length;h++)m(a[h]);return i.__useDefault?i["default"]:i})}}}("undefined"!=typeof self?self:global)(["1"],[],function(a){!function(){var b=a;if("undefined"!=typeof window&&"undefined"!=typeof document&&window.location)var c=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");b.set("@@cjs-helpers",b.newModule({getPathVars:function(a){var b,d=a.lastIndexOf("!");b=-1!=d?a.substr(0,d):a;var e=b.split("/");return e.pop(),e=e.join("/"),"file:///"==b.substr(0,8)?(b=b.substr(7),e=e.substr(7),isWindows&&(b=b.substr(1),e=e.substr(1))):c&&b.substr(0,c.length)===c&&(b=b.substr(c.length),e=e.substr(c.length)),{filename:b,dirname:e}}}))}(),a.register("2",["3"],function(a){var b;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";"function"!=typeof b&&!function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e])}return b}}(),Object.copy=function(a){return b({},a)},a("default",{})}}}),a.register("4",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={lastCollision:0,lastAction:0,collision_foreach:function(a,b){if(void 0!==a.collision&&null!==a.collision&&a.collision.count>0)for(var c=0;c<a.collision.list.length;c++)for(var d=0;2>d;d++){var e=a.item[a.collision.list[c][d]],f=a.item[a.collision.list[c][(d+1)%2]];for(var g in e.responseSet)b(e.responseSet[g],f)}},detect:function(a){void 0===a&&(a=this),$Z.iter-b.lastCollision>=a.config.frameDurationFactor&&(a.collision_detect(),b.collision_foreach(a,function(a,b){a.onSwitch&&(a.performSwitch=!0,a.sourceItem=b)}),b.lastCollision=$Z.iter)},perform:function(a){void 0===a&&(a=this),$Z.iter-b.lastAction>=a.config.frameDurationFactor&&(b.collision_foreach(a,function(a){a.performSwitch&&(a.performSwitch=!1,a.perform())}),b.lastAction=$Z.iter)}},a("default",b)}}}),a.register("5",[],function(a){"use strict";var b,c;return{setters:[],execute:function(){b=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext||!1,c={context:new b,buffer:void 0,source:void 0,gain:void 0,volume:1,loop:!1,setup:function(a){void 0===a&&(a=this);var b=c.context.createBufferSource();if(void 0!==a.buffer&&null!==a.buffer?b.buffer=a.buffer:console.log("audioHelper.setup: no audio loaded"),b.loop=a.loop,void 0===a.gain){var d=void 0===c.context.createGain?c.context.createGainNode():c.context.createGain();d.value=a.volume,d.connect(c.context.destination),a.gain=d}else var d=a.gain;return b.connect(d),b},fade:function(a,b,d,e){void 0===e&&(e=this),void 0===a&&(a=1),void 0===b&&(b=0),void 0===d&&(void 0===e.gain&&e.setup(),d=e.gain.gain.value>0?0:e.volume);var f=e.gain,g=c.context.currentTime;f.gain.cancelScheduledValues(g),f.gain.linearRampToValueAtTime(f.gain.value,g+b),f.gain.linearRampToValueAtTime(d,g+a+b)},play:function(a,b,d,e){void 0===e&&(e=this),void 0===d&&(d=this.buffer);var f=e.setup(),g=e.gain;void 0===a&&(a=0),void 0===b&&(b=!0);var h;h=b?c.context.currentTime:0,g.gain.cancelScheduledValues(h),g.gain.value=this.volume,f.start?f.start(h+a):f.noteOn(h+a)}},c.buffer=c.context.createBuffer(2,735,44100),a("default",c)}}}),a.register("6",["7"],function(a){var b,c;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";c={Nval:null,image:null,pixelwise:function(a){void 0===a&&(a=this);var d=a.item,e=a.width,f=a.height,g=d.length,h=e*f,i=2,j=h*i;if(c.Nval!==j)c.image=new Array(j);else for(var k=0;k<c.image.length;k++)c.image[k]=void 0;var l=c.image,m={};m.index={};for(var n=0;g>n;n++)if((void 0===d[n].inert||!d[n].inert)&&void 0!==d[n].image){if(void 0===d[n].image.originalCanvas)var o=d[n].image,p=$Z.helper.image.get_data(o);else var o=d[n].image.originalCanvas,p=$Z.helper.image.get_data(d[n].image.originalCanvas);if(void 0!==d[n].viz)var q=d[n].viz.viewportX,r=d[n].viz.viewportY;else var q=0,r=0;for(var s=Math.round(d[n].x-q),t=Math.round(d[n].y-r),u=Math.max(0,Math.min(f,t)),v=Math.max(0,Math.min(f,t+p.height)),w=Math.max(0,Math.min(e,s)),x=Math.max(0,Math.min(e,s+p.width)),y=4e3,z=Math.ceil(h/y),A=u;v>A;A++)for(var B=w;x>B;B++){var k=A*e+B;if(k%z===0){var C=k*i,D=A-u,E=B-w;0>t&&(D+=-t),0>s&&(E+=-s);var F=Math.floor(D*o.width+E),G=p.data[4*F+3];if(G>0)for(var H=0;i-1>H;H++)void 0!==l[C+H]?(l[C+H+1]=n,m.index[l[C+H]*g+n]=!0):0==H&&(l[C]=n)}}}var I=b(m.index);m.count=0,m.list=new Array(I.length);for(var J=0;J<I.length;J++){var A=Math.floor(I[J]/g),B=I[J]%g;m.list[J]=[A,B],m.count++}a.collision=m}},a("default",c)}}}),a.register("8",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={item:function(a,c,d){if(void 0===a&&(a=this),b.image(a),void 0!==a.child)for(var e=0;e<a.child.length;e++){a.child[e].x=a.x,a.child[e].y=a.y,a.child[e].angle=a.angle,a.child[e].xScale=a.xScale,a.child[e].yScale=a.yScale;var f=a.child[e].opacity;a.childFade===!0&&(a.child[e].opacity=a.child[e].opacity*a.opacity),a.child[e].render(),a.child[e].opacity=f}},indexed:function(a,b,c,d){if(void 0===b)var b=$Z.helper.image.create(c,d);else b.width=b.width;for(var e=b.context(),f=0;f<a.length;f++)if(a[f].uiSwitch!==!1){var g;g=void 0!==a[f].image.originalCanvas?a[f].image.originalCanvas:a[f].image;var h=g.context().getImageData(0,0,a[f].image.width,a[f].image.height),i=$Z.helper.image.to_index(h,f),j=$Z.helper.image.create(a[f].image.width,a[f].image.height);if(j.context().clearRect(0,0,j.width,j.height),j.context().putImageData(i,0,0),void 0!==a[f].xOrigin)var k=a[f].xOrigin*a[f].xScale;else var k=0;if(void 0!==a[f].yOrigin)var l=a[f].yOrigin*a[f].yScale;else var l=0;e.drawImage(j,a[f].x-k,a[f].y-l)}return b},image:function(a,b,c){if(void 0===a&&(a=this),0!==a.opacity){void 0===b&&(b=a.viz.fullContext),void 0===c&&(c=document.ratio),void 0===a.xScale&&(a.xScale=1),void 0===a.yScale&&(a.yScale=1);var d,e;a.fixed===!0?(d=a.viz.viewportX,e=a.viz.viewportY):(d=0,e=0);var f=a.xOrigin*a.xScale||0,g=a.yOrigin*a.yScale||0,h=(a.x+a.viz.xShift+d-f)*c,i=(a.y+a.viz.yShift+e-g)*c;if(h=Math.floor(h),i=Math.floor(i),void 0!==a.opacity){var j=b.globalAlpha;b.globalAlpha=a.opacity;var k=Math.floor(c*(a.x+a.xAngle)),l=Math.floor(c*(a.y+a.yAngle));b.translate(k,l),b.rotate(a.angle),b.translate(-k,-l);var m=Math.floor(a.image.width*a.xScale),n=Math.floor(a.image.height*a.yScale);b.drawImage(a.image,0,0,a.image.width,a.image.height,h,i,m,n),b.setTransform(1,0,0,1,0,0),b.globalAlpha=j}else b.drawImage(a.image,h,i)}},rect:function(a,b,c){void 0===a&&(a=this),void 0===b&&(b=$Z.helper.image.create(a.width,a.height).context()),void 0===c&&(c=document.ratio);var d=b.fillStyle;void 0===a.color&&(a.color=d);var e=b.strokeStyle;void 0===a.stroke&&(a.stroke=e);var f,g;if(void 0!==a.viz){var h,i;a.fixed===!0?(h=a.viz.viewportX,i=a.viz.viewportY):(h=0,i=0),f=a.x+a.viz.xShift+h,g=a.y+a.viz.yShift+i}else f=a.x,g=a.y;var g,j=f*c,k=g*c;j=Math.floor(j),k=Math.floor(k),b.beginPath(),b.fillStyle=a.color,b.strokeStyle=a.stroke,void 0!==a.opacity&&(b.globalAlpha=a.opacity);var l=Math.floor(c*(a.x+a.xAngle)),m=Math.floor(c*(a.y+a.yAngle));return b.translate(l,m),b.rotate(a.angle),b.translate(-l,-m),b.rect(j,k,Math.floor(a.width*c),Math.floor(a.height*c)),b.fill(),b.stroke(),b.closePath(),b.setTransform(1,0,0,1,0,0),b.fillStyle=d,b.strokeStyle=e,b.canvas},circle:function(a,b){void 0===a&&(a=this);var c=a.lineWidth||0;if(void 0===b){var d=2,e=2*(a.radius+c)+d;b=$Z.helper.image.create(e,e).context()}b.beginPath();var f=a.x||a.radius+c+d,g=a.y||a.radius+c+d;f=Math.floor(f),g=Math.floor(g);var h=a.radius;return b.arc(f,g,h,0,2*Math.PI,!0),void 0!==a.fill&&(b.fillStyle=a.fill,b.fill()),void 0!==a.stroke&&(b.lineWidth=c,b.strokeStyle=a.stroke,b.stroke()),b.closePath(),b.canvas}},a("default",b)}}}),a.register("9",["3"],function(a){var b,c,d;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";c={foreach:function(a,b,c){void 0===c&&(c=-1);for(var d=a.context(),e=d.getImageData(0,0,a.width,a.height),f=e.data,g=f.length/4,h=0,i=(new Array(g),0);g>i;i++)3>c&&0===f[h+3]?h+=4:(c>=0&&4>c?f[h+c]=b(f[h+c]):-1===c&&(f[h+0]=b(f[h+0]),f[h+1]=b(f[h+1]),f[h+2]=b(f[h+2])),h+=4);d.putImageData(e,0,0)},opacity:function(a,b){c.foreach(a,function(){return b},3)},binary_opacity_filter:function(a,b){for(var c=a.context(),d=c.getImageData(0,0,a.width,a.height),e=d.data,f=e.length/4,g=0,h=new Array(f),i=0;f>i;i++)e[g+3]>0&&(h[f]=e[g+3]),g+=4;void 0===b&&(b=68),g=0;for(var i=0;f>i;i++)e[g+3]<b?e[g+3]=0:e[g+3]=255,g+=4;c.putImageData(d,0,0)},color_filter:function(a,b,d){function e(a,b,c){var d=(1-c)*a+c*b;return Math.round(d)}void 0===d&&(d=1),d>1&&(d=1),0>d&&(d=0);for(var f=$Z.helper.image.copy(a),g=function(a){void 0!==b[a]&&c.foreach(f,function(c){return e(c,b[a],d)},a)},h=0;h<b.length;h++)g(h);return f},fade_transition:function(a){var b=1e3;void 0===a.duration&&(a.duration=b);var c=$Z.helper.transition.linear_transition_func("opacity",a.duration)(a.opacity);return void 0!==a.end&&(c.end=a.end),void 0!==a.child&&(c.child=a.child),void 0!==a.pause&&(c.pause=a.pause),c},fade_sequence:function(a){void 0===a&&(a={});var b=(a.valueList,a.duration||1e3),c=a.value,d=$Z.helper.transition.fixed_duration_linear("opacity",b);return $Z.helper.transition.new_sequence(c,d)},explode:function(a,d,e,f,g){void 0===g&&(g=this),void 0===a&&(a=24),void 0===d&&(d=1500),void 0===e&&(e=!0),void 0===f&&(f=!0),e&&$Z.helper.item.remove(g);for(var h,i,j=Math.floor(g.image.height/a),k=Math.floor(g.image.width/a),l=j*k,m=new Array(l),n=a,o=a,p=0,q=0,r=a,s=a,t=300,u=0;j>u;u++)for(var v=0;k>v;v++){var w=$Z.helper.image.create(a,a),x=w.context();h=Math.floor(v*a/document.ratio),i=Math.floor(u*a/document.ratio),x.drawImage(g.image,h,i,n,o,p,q,r,s);var y=u*k+v,z=$Z.helper.transition.rounded_linear_transition_func("x",d)(2*(Math.random()-.5)*t+g.x+h);m[y]=b($Z.helper.item.setup(),{viz:g.viz,x:g.x+h,y:g.y+i,image:w,opacity:1,render:$Z.helper.draw.image,inert:!0,transition:[z,$Z.helper.transition.rounded_linear_transition_func("y",d)(2*(Math.random()-.5)*t+g.y+i)]}),z.end=$Z.helper.transition.remove_end(m[y]),f&&c.fade.call(m[y],{duration:d})}$Z.helper.item.add(viz,m)}},d={image:c,zoom_inout:function(a,b){void 0===b&&(b=this),void 0===a&&(a={});var c=-2*Math.floor(.04*b.screenCanvas.width);if(void 0===a.width)var d=b.screenCanvas.width+c;else d=a.width*document.ratio;if(void 0===a.height)var e=b.screenCanvas.height+c;else e=a.height*document.ratio;if(void 0===a.x)var f=Math.floor(b.viewportX-.25*c);else var f=a.x*document.ratio;if(void 0===a.y)var g=Math.floor(b.viewportY-.25*c);else var g=a.y*document.ratio;if(void 0===a.duration)var h=b.fadeDuration;else var h=a.duration;var h=.25*h;if(void 0===a.shakeSwitch)var i=!1;else var i=a.shakeSwitch;f=Math.max(0,Math.min(b.width*document.ratio,f)),g=Math.max(0,Math.min(b.height*document.ratio,g));var j=$Z.helper.transition.rounded_linear_transition_func("viewportWidth",h)(d),k=$Z.helper.transition.rounded_linear_transition_func("viewportHeight",h)(e),l=$Z.helper.transition.rounded_linear_transition_func("viewportX",h)(f),m=$Z.helper.transition.rounded_linear_transition_func("viewportY",h)(g),n=$Z.helper.transition.rounded_linear_transition_func("viewportWidth",h)(b.screenCanvas.width),o=$Z.helper.transition.rounded_linear_transition_func("viewportHeight",h)(b.screenCanvas.height),p=$Z.helper.transition.rounded_linear_transition_func("viewportX",h)(0),q=$Z.helper.transition.rounded_linear_transition_func("viewportY",h)(0);j.child=n,k.child=o,l.child=p,m.child=q,j.pause=.45*h,k.pause=.45*h,l.pause=.45*h,m.pause=.45*h,i&&(j.end=function(){b.shake()}),b.add_transition(j),b.add_transition(k),b.add_transition(l),b.add_transition(m)},zoom:function(a,b){void 0===b&&(b=this),b.add_transition(d.zoom_transition(a))},zoom_transition:function(a){void 0===a.duration&&(a.duration=1e3);var b=a.duration,c=$Z.helper.transition.rounded_linear_transition_func("viewportWidth",b)(a.width),d=$Z.helper.transition.rounded_linear_transition_func("viewportHeight",b)(a.height),e=$Z.helper.transition.rounded_linear_transition_func("viewportX",b)(a.x),f=$Z.helper.transition.rounded_linear_transition_func("viewportY",b)(a.y);return[c,d,e,f]},method:{flash:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a=5),void 0===b&&(b=100);for(var d=function(){},e=[d,$Z.helper.draw.item],f=new Array(2*a),g=0;2*a>g;g++)f[g]=$Z.helper.transition.new_step("render",e[g%e.length],b);return f=$Z.helper.transition.sequence(f),c.add_transition(f),f},shake:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a="x"),void 0===b&&(b="y");var d=[1,-1,-1,1],e=[1,-1,1,-1],f=1.5*document.ratio,g=1,h=9;xTransition=new Array(h),yTransition=new Array(h);for(var i=0;h-1>i;i++)xTransition[i]=c.transitionSet[a](Math.round(Math.random()*d[(i+$Z.iter)%d.length]*f)),yTransition[i]=c.transitionSet[b](Math.round(Math.random()*e[(i+3*$Z.iter)%d.length]*f)),f*=g;xTransition[kstep]=c.transitionSet[a](0),yTransition[kstep]=c.transitionSet[b](0),xTransition=$Z.helper.transition.sequence(xTransition)[0],yTransition=$Z.helper.transition.sequence(yTransition)[0];c.add_transition([xTransition,yTransition])}}},a("default",d)}}}),a.register("a",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={upsample:function(a){var c=b.block_copy(a,document.ratio);return c},set_position:function(a){void 0===a&&(a=this);var b={},c=window.innerWidth,d=a.width/c,e=window.innerHeight,f=a.height/e,g=!0,h=a.width>=a.height;return h&&f>d&&(g=!1),h||d>f||(g=!1),g?(b.width=c,b.height=Math.round(a.height/d),b.left=0,b.top=Math.round(.5*(e-b.height)),b.scale=1/d):(b.height=e,b.width=Math.round(a.width/f),b.top=0,b.left=Math.round(.5*(c-b.width)),b.scale=1/f),(a.style.width!==b.width||a.style.height!==b.height)&&(a.style.width=b.width,a.style.height=b.height,a.style.left=b.left,a.style.top=b.top),b},place:function(a){void 0===a&&(a=this);for(var b=document.body.getElementsByTagName("canvas"),c=0;c<b.length;c++)b[c].parentNode.removeChild(b[c]);document.body.appendChild(a),a.style.position="fixed",a.parentNode.style.transformOrigin="0 0"},get_data:function(a){return a.context().getImageData(0,0,a.width,a.height)},view:function(a){var b=a.toDataURL("image/png");console.log("dataUrl",b);var c=window.open();c.document.write('<img src="'+b+'"/>')},text:function(a){void 0===a&&(a=this);var c=String(a.text),d=a.sprite,e=d[c[0]][0].width,f=d[c[0]][0].height;if(void 0===a.xShift)var g=0;else var g=a.xShift;for(var h=b.create(e*c.length+(c.length-1)*g,f),i=0;i<c.length;i++)h.context().drawImage(d[c[i]][0],Math.floor(g*i+e*i),0);return h},text_sprite:function(a){void 0===a&&(a={});for(var c=(a.font||"11px Lucida Console","0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?.-!@#$%^&*()[]{}/ ".split("")),d={},e=0;e<c.length;e++){var f=b.word({font:a.font||"Lucida",px:a.px||72,color:a.color||"#FFFF30",text:c[e]});d[c[e]]=[f]}return d},word_block:function(a){var c=b.word(a),d=10,e=2,f=b.create(c.width+2*d,c.height+2*e),g=f.context(),h={x:0,y:0,width:f.width,height:f.height,color:"#FFF",stroke:"rgba(0, 0, 0, 0)",opacity:1};return $Z.helper.draw.rect(h,g),g.drawImage(c,d,e),g.lineWidth=1,g.strokeStyle="rgba(0, 0, 0, 1)",g.rect(0,0,f.width,f.height),g.stroke(),f=b.adjust_ratio(f)},word:function(a){var c;void 0===a.binarySwitch&&(a.binarySwitch=!0),c=void 0===a.px?12:a.px;var d;d=void 0===a.font?"Courier":a.font;var e=b.create(),f=e.context();f.font=c+"px "+d;var g=f.measureText(a.text),h=Math.ceil(g.width),i=c;if(e.width=h,e.height=i,f.font=c+"px "+d,f.textBaseline="bottom",void 0===a.color&&(a.color="rgba(0, 0, 0, 1)"),f.fillStyle=a.color,f.fillText(a.text,0,c),a.binarySwitch===!0){var j=50;$Z.helper.effect.image.binary_opacity_filter(e,j)}return e},clear_color:function(a,c){void 0===c&&(c=this);var d=c;c=b.get_data(d);for(var e=c.data.length/4,f=20,g=0;e>g;g++){var h=4*g,i=c.data[h+0],j=c.data[h+1],k=c.data[h+2],l=b.color_distance(i,j,k,a);f>l&&(c.data[h+0]=0,c.data[h+1]=0,c.data[h+2]=0,c.data[h+3]=0)}d.context().putImageData(c,0,0)},color_distance:function(a,b,c,d){return Math.abs(a-d[0])+Math.abs(b-d[1])+Math.abs(c-d[2])},clear_rect:function(a,c){var d=b.create(a.width,a.height),e=d.context();return e.drawImage(a,0,0),e.clearRect(c.x,c.y,c.width,c.height),d},keep_rect:function(a,c){var d=b.create(a.width,a.height),e=d.context();return e.drawImage(a,c.x,c.y,c.width,c.height,c.x,c.y,c.width,c.height),d},to_canvas:function(a){var c=$Z.helper.loader.image.cache[a],d=b.create(),e=d.context();return d.width=c.width,d.height=c.height,e.drawImage(c,0,0),d},create:function(a,c,d){var e=document.createElement("canvas");if(e.setAttribute("width",a),e.setAttribute("height",c),e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1,e.context=b.context2d,e.place=b.place,e.set_position=b.set_position,e.clear_color=b.clear_color,void 0!==d)for(var f=function(a){h=function(){return d[a]},$Z.helper.effect.image.foreach(e,h,a)},g=0;g<d.length;g++){var h;f(g)}return e},context2d:function(a){void 0===a&&(a=this);var b=a.getContext("2d");return b.mozImageSmoothingEnabled=!1,b.webkitImageSmoothingEnabled=!1,b.msImageSmoothingEnabled=!1,b.imageSmoothingEnabled=!1,b},adjust_ratio:function(a){var c=b.upsample(b.get_data(a)).canvas;return void 0!==a.sourceCollisionImage&&(c.sourceCollisionImage=a.sourceCollisionImage),void 0!==a.targetCollisionImage?c.targetCollisionImage=a.targetCollisionImage:c.targetCollisionImage=a,c.originalCanvas=a,c},copy:function(a){var c=b.create(a.width,a.height),d=c.context();return d.drawImage(a,0,0),c.originalCanvas=a.originalCanvas,c},block_copy:function(a,c){for(var d=b.create(a.width*c,a.height*c),e=d.context(),f=e.getImageData(0,0,d.width,d.height),g=a.data,h=f.data,i=a.width*a.height,j=0;i>j;j++)for(var k=j%a.width,l=Math.floor(j/a.width),m=c*k,n=c*l,o=4*j,p=g[o+0],q=g[o+1],r=g[o+2],s=g[o+3],t=0;c>t;t++)for(var u=0;c>u;u++){var v=m+t,w=n+u,x=w*f.width+v,y=4*x;h[y+0]=p,h[y+1]=q,h[y+2]=r,h[y+3]=s}e.putImageData(f,0,0);var z={data:f,context:e,canvas:d};return z},new_data:function(a,c){var d=b.create(a,c),e=d.context().createImageData(parseInt(a),parseInt(c));return e},flip_image:function(a){for(var c=a.context(),d=c.getImageData(0,0,a.width,a.height),e=b.new_data(a.width,a.height),f=d.data.length/4,g=0;f>g;g++){var h=b.flip_index(g,a.width,a.height),i=4*g,j=4*h;e.data[j+0]=d.data[i+0],e.data[j+1]=d.data[i+1],e.data[j+2]=d.data[i+2],e.data[j+3]=d.data[i+3]}var k=b.create(a.width,a.height);return k.context().putImageData(e,0,0),k},flip_index:function(a,b,c){var d=Math.floor(a/b),e=a%b,f=b-e-1,g=d*b+f;return g},get_original:function(a){return a.originalCanvas},to_index:function(a,c){for(var d=b.new_data(a.width,a.height),e=d.data.length/4,f=0;e>f;f++){var g=4*f,h=a.data[g+3];h>0&&(d.data[g+0]=c+1,d.data[g+1]=0,d.data[g+2]=0,d.data[g+3]=255)}return d}},a("default",b)}}}),a.register("b",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={down:function(a,b){function c(){if("touchstart"===a.type)for(var c=0;c<e.length;c++)b.viz.input.response[d].call(b.viz,e[c]);else b.viz.input.response[d].call(b.viz,e)}void 0===b&&(b=this);var d,e;switch(a.type){case"keydown":d="keyboard",e=a;break;case"mousedown":d="screen",e=a;break;case"touchstart":d="screen",e=a.touches}var f={prep:c,viz:b.viz};$Z._prep.push(f)},up:function(a,b){void 0===b&&(b=this),$Z.helper.audio.play(),$Z.prep([b.viz])},response:{keyboard:function(a,b){void 0===b&&(b=this),void 0!==b.keyboard_callback&&b.keyboard_callback(a)},screen:function(a,c){void 0===c&&(c=this),void 0===c.screen_callback?b.response.screen_callback.call(c,a):c.screen_callback(a)},screen_callback:function(a,b){if(void 0===b&&(b=this),void 0!==b.ui){var c=b.canvas.set_position(),d=Math.round((a.clientX-c.left)/c.scale),e=Math.round((a.clientY-c.top)/c.scale);$Z.helper.draw.indexed(b.ui.item,b.ui.canvas);var f=b.ui.canvas.context().getImageData(d,e,1,1).data,g=f[0]-1;g>=0&&b.ui.item[g].callback()}}}},a("default",b)}}}),a.register("c",["3"],function(a){var b,c;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";c={setup:function(a,d){void 0===d&&(d=this),void 0===a&&(a={}),void 0===a.opacity&&(a.opacity=1),void 0===a.inert&&(a.inert=!0);var e,f;a.centerSwitch===!0?(e=.5*a.image.width,f=.5*a.image.height):(e=0,f=0);var g={delayCount:0,responseSet:{},config:a,viz:a.viz||d,x:a.x||0,y:a.y||0,angle:a.angle||0,xOrigin:a.xOrigin||e,yOrigin:a.yOrigin||f,xAngle:a.xAngle||0,yAngle:a.yAngle||0,xScale:a.xScale||1,yScale:a.yScale||1,type:a.type,element:a.element,enter:a.enter,exit:a.exit,opacity:a.opacity,color:a.color,width:a.width,height:a.height,image:a.image,child:a.child,childFade:a.childFade,inert:a.inert,fixed:a.fixed,uiSwitch:a.uiSwitch||!1,callback:a.callback,addSwitch:a.addSwitch||!0,render:a.render||$Z.helper.draw.item};return b(g,c.method),b(g,$Z.helper.transition.method),g.addSwitch===!0&&g.add(),g},method:{collision_image:function(a,b){void 0===b&&(b=this);var c=a+"CollisionImage";if(void 0!==b.image[c]&&null!==b.image[c]){var d=b.image[c];return d}},default_child:function(a){void 0===a&&(a=this),void 0===a.child&&(a.child=[]);var b=$Z.helper.effect.image.color_filter(a.image,[255,255,255]);a.white=Object.copy(a),a.white.childFade=!0,a.white.child=void 0,a.white.image=b,a.white.opacity=0,a.child.push(a.white)},zoom:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a=.5),void 0===b&&(b=c.viz.fadeDuration),c.viz.zoom({duration:b,x:c.x,y:c.y,width:c.viz.width*a,height:c.viz.height*a})},add:function(a,b){if(void 0===b&&(b=this),void 0===a&&(a=this.viz),void 0===a.item&&(a.item=[]),b.constructor!==Array)a.stagingArray.push(b);else for(var c=0;c<b.length;c++)a.stagingArray.push(b[c])},remove:function(a){void 0===a&&(a=this),a.removeSwitch=!0},scale:function(a,b,c){void 0===c&&(c=this),void 0===b&&(b=a),c.xScale=a,c.yScale=b},loop:function(a,b){void 0===b&&(b=this),a=a.constructor===String?b[a]:a,b.add_transition(b.loop_trans(a))},call:function(a,b,c){if(void 0===c&&(c=this),a.constructor===Array)for(var d=0,e=0;e<a.length;e++){if(b.constructor===Number)var f=b*(e+1);else b.constructor===Array?(d+=b[e],f=d):console.log("item_helper_call: delay is not a Number of Array");if(a[e].constructor===String)var g=c[a[e]];else var g=a[e];c.run_callback(g,f)}else a.constructor===String&&(a=c[a]),c.run_callback(a,b)},run_callback:function(a,b,c){void 0===c&&(c=this),c.delayCount++;var d="delay"+c.delayCount;c[d]=null;var e=$Z.helper.transition.new_step(d,void 0,b);e.end=function(){a.call(c)},c.add_transition(e)},flash:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a=1),void 0===b&&(b=100);for(var d=function(){},e=[d,$Z.helper.draw.item],f=new Array(2*a),g=0;2*a>g;g++)f[g]=$Z.helper.transition.new_step("render",e[g%e.length],b);return f=$Z.helper.transition.sequence(f),void 0!==c.add_transition&&c.add_transition(f),f},shake:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a="x"),void 0===b&&(b="y");var d=[1,-1,-1,1],e=[1,-1,1,-1],f=1.5*document.ratio,g=1,h=9;xTransition=new Array(h),yTransition=new Array(h);for(var i=0;h-1>i;i++)xTransition[i]=c.transitionSet[a](Math.round(Math.random()*d[(i+$Z.iter)%d.length]*f)),yTransition[i]=c.transitionSet[b](Math.round(Math.random()*e[(i+3*$Z.iter)%d.length]*f)),f*=g;xTransition[kstep]=c.transitionSet[a](0),yTransition[kstep]=c.transitionSet[b](0),xTransition=$Z.helper.transition.sequence(xTransition)[0],yTransition=$Z.helper.transition.sequence(yTransition)[0];c.add_transition([xTransition,yTransition])},fade:function(a,b){if(void 0===b&&(b=this),void 0===a&&(a={}),void 0===a.opacity){var c=.5;b.opacity<c?a.opacity=1:a.opacity=0}var d=$Z.helper.effect.image.fade_transition(a),e=a.replacementSwitch||!0;b.add_transition(d,e)},whiteflash:function(a,b){void 0===b&&(b=this),void 0===a&&(a=b.duration||b.viz.fadeDuration),void 0===b.white&&b.default_child();var c=$Z.helper.transition.fixed_duration_creator("opacity",a,$Z.helper.transition.linear_interp);b.white.add_sequence([1,0],c)},loop_fade:function(a,b,c){void 0===c&&(c=this),void 0===a&&(a=c.viz.fader),void 0===b&&(b=[1,0]),c.loop(function(){return a(b)})},focus:function(a){void 0===a&&(a=this);var b=$Z._item.indexOf(a),c=$Z._item[$Z._item.length-1];c!==a&&($Z._item[b]=c,$Z._item[$Z._item.length-1]=a)}},text:function(a){var c=$Z.helper.image.text({text:a.text,sprite:a.sprite,color:a.color||"#FFF"}),d=b({image:c},a);return a.viz.setup_item(d)}},a("default",c)}}}),a.register("d",[],function(a){"use strict";var b,c,d;return{setters:[],execute:function(){b={loading:!1,cache:{},loadingStats:{total:null,count:null,finalCallback:null},load:function(a){if(void 0!==b.cache[a])b.callback_handler();else{if(!AudioContext)return void alert("Web Audio API is not supported by your browser.");var c=Object.copy(audioHelper),d=new XMLHttpRequest;d.open("get",a,!0),d.responseType="arraybuffer",d.onload=function(){audioHelper.context.decodeAudioData(d.response,function(d){c.buffer=d,b.cache[a]=c,b.callback_handler()})},d.send()}return c},callback_handler:function(){b.loadingStats.count++,b.loadingStats.count===b.loadingStats.total&&(b.loadingStats.finalCallback(),b.loading=!1)},preload:function(a,c){return b.loading?!1:0===a.length?void c():(b.loading=!0,b.loadingStats.total=a.length,b.loadingStats.count=0,b.loadingStats.finalCallback=c,void a.forEach(function(a){b.load(a)}))}},c={loading:!1,cache:{},loadingStats:{total:null,count:null,finalCallback:null},load:function(a){if(void 0!==c.cache[a])c.callback_handler();else{var b=new Image;b.onload=c.callback_handler,b.src=a,c.cache[a]=b}return b},callback_handler:function(){c.loadingStats.count++,c.loadingStats.count===c.loadingStats.total&&(c.loadingStats.finalCallback(),c.loading=!1)},preload:function(a,b){if(!c.loading){if(0===a.length)return void b();c.loading=!0,c.loadingStats.total=a.length,c.loadingStats.count=0,c.loadingStats.finalCallback=b,a.forEach(function(a){c.load(a)})}}},d={image:c,audio:b,all:function(a,d,e){document.ratio=2,c.preload(a,function(){b.preload(d,function(){var a=document.getElementById("loading");null!==a&&(a.style.visibility="hidden"),e()})})}},a("default",d)}}}),a.registerDynamic("e",["f","10","11"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("f"),g=a("10"),h=a("11");return c.exports=function(a,b){var c=(g.Object||{})[a]||Object[a],d={};d[a]=b(c),f(f.S+f.F*h(function(){c(1)}),"Object",d)},d.define=e,c.exports}),a.registerDynamic("12",["13","e"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("13");return a("e")("keys",function(a){return function(b){return a(f(b))}}),d.define=e,c.exports}),a.registerDynamic("14",["12","10"],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,a("12"),c.exports=a("10").Object.keys,d.define=e,c.exports}),a.registerDynamic("7",["14"],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,c.exports={"default":a("14"),__esModule:!0},d.define=e,c.exports}),a.register("15",["7"],function(a){var b,c;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";c={foreach:function(a,c){for(var d=b(a),e={},f=0;f<d.length;f++)a[d[f]].constructor===Array?e[d[f]]=a[d[f]].map(c):e[d[f]]=a[d[f]];return e},make_sheet:function(a){function b(a){return a.width}function d(a){return a.height}widthSet=c.foreach(a,b),heightSet=c.foreach(a,d);var e=0,f=0,g=[];for(var h in a)if(a[h].constructor===Array){e++;var i=widthSet[h].reduce(function(a,b){return a+b}),j=heightSet[h][0];g.push(j),i>f&&(f=i)}var k=g.reduce(function(a,b){return a+b}),l=$Z.helper.image.create(f,k),m=l.context(),n=0;for(var h in a){var o=a[h];if(o.constructor===Array)for(var p=0,q=0;q<o.length;q++)m.drawImage(o[q],p,n),p+=o[q].width;n+=g.shift()}$Z.helper.image.view(l)},is_blank:function(a){for(var b=!0,c=0;c<a.data.length;c++)if(0!==a.data[c]){b=!1;break}return b},get:function(a,b,d,e,f){if(void 0===f&&(f=!0),e.constructor===Number){var g=e;e=new Array(b.length);for(var h=0;h<e.length;h++)e[h]=g}if(d.constructor===Number){
var i=d;d=new Array(b.length);for(var j=0;j<d.length;j++)d[j]=i}for(var k=Math.max.apply(null,e),l=b.length,m={},n=0,h=0;l>h;h++){for(var o=[],p=Math.floor(a.width/d[h]),q=0;p>q;q++){if(f)var r=$Z.helper.image.create(d[h],k);else var r=$Z.helper.image.create(d[h],e[h]);var s=r.context(),t=q*r.width;f?s.drawImage(a,t,n,r.width,e[h],0,k-e[h],r.width,e[h]):s.drawImage(a,t,n,r.width,e[h],0,0,r.width,e[h]);var u=$Z.helper.image.get_data(r),v=c.is_blank(u);if(v)break;r=$Z.helper.image.adjust_ratio(r),o.push(r)}m[b[h]]=o,n+=e[h]}return m},get_text:function(a,b,d,e){var f=$Z.helper.image.to_canvas(a);return void 0===e&&(e="0123456789abcdefghijklmnopqrstuvwxyz".split("")),c.get(f,e,b,d)},horizontal_flip:function(a){for(var d=b(a),e={},f=0;f<d.length;f++)a[d[f]].constructor===Array?e[d[f]]=c.flip_sprite(a[d[f]]):e[d[f]]=a[d[f]];return e},flip_sprite:function(a){for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=$Z.helper.image.flip_image(a[c]),void 0!==a[c].originalCanvas&&(b[c].originalCanvas=$Z.helper.image.flip_image(a[c].originalCanvas)),void 0!==a[c].sourceCollisionImage&&(b[c].sourceCollisionImage=$Z.helper.image.flip_image(a[c].sourceCollisionImage)),void 0!==a[c].targetCollisionImage?b[c].targetCollisionImage=$Z.helper.image.flip_image(a[c].targetCollisionImage):b[c].targetCollisionImage=b[c];return b},animate:function(a,b,c,d){var e;e=void 0===d?a:a.concat(d);for(var f=e.length,g=new Array(f),h=0;f>h;h++){var i=b(e[h]);h===f-1&&(i.end=c),g[h]=i}return transitionHelper.sequence(g)},animate_loop:function(a,b,c,d,e){var f,g=Object.copy(a);f=void 0===e?b:b.concat(e);var h=f.length;void 0===a.Nstep&&(a.Nstep=1,g.Nstep=1);var i=a.position;i%=h;var j=[],k=[],l=[];g.totalDur=g.Nstep*g.frameDur;var m=a.Nstep;if(i>0){for(var n=Math.min(h-i,m),o=0;n>o;o++)j.push(f[i+o]);i+=n-1,i===h-1&&m>n?m-=n:m=0}if(m>0&&(i=m,m>=h)){for(var p=Math.floor(m/h),q=0;p>q;q++)k=k.concat(k,f);m-=p*h}if(m>0){i=m-1;for(var r=0;m>r;r++)l.push(f[r])}var s=j.concat(k.concat(l));return g.position=(g.position+a.Nstep)%h,g.animation=animate(s,c,d),g}},a("default",c)}}}),a.register("16",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={interp:function(a){return void 0===this.power?b.linear_interp(a):b.power_interp.call(this,a)},linear_interp:function(a){return(1-a)*this.startValue+a*this.endValue},power_interp:function(a){return a=Math.pow(a,Math.max(0,this.power)),b.linear_interp.call(this,a)},rounded_linear_interp:function(a){return Math.round(b.linear_interp(a))},rounded_interp:function(a){return Math.round(b.interp(a))},color_interp:function(a){var b=this.startValue,c=this.endValue;b=b.slice(1),c=c.slice(1),3===b.length&&(b=b.replace(/([0-9a-f])/gi,"$1$1")),3===c.length&&(c=c.replace(/([0-9a-f])/gi,"$1$1"));for(var d="#",e=0;3>e;e++){var f=parseInt(b.slice(2*e,2*(e+1)),16),g=parseInt(c.slice(2*e,2*(e+1)),16),h=Math.min(255,Math.round((1-a)*f+a*g));h=h.toString(16).toUpperCase(),1===h.length&&(h="0"+h),d+=h}return d},build_func:function(a,b,c){return function(d){return{varName:a,duration:b,interpFunc:c,endValue:d}}},creator:function(a,b){return this.build_func(a,b,this.interp)},linear_transition_func:function(a,b){return this.build_func(a,b,this.linear_interp)},rounded_linear_transition_func:function(a,b){return this.build_func(a,b,this.rounded_linear_interp)},color_transition_func:function(a,b){return this.build_func(a,b,this.color_interp)},step_interp:function(a){return this.endValue},step_func:function(a,c){return b.build_func(a,c,b.step_interp)},linear_func:function(a,c){return b.build_func(a,c,b.linear_interp)},rounded_linear_func:function(a,c){return b.build_func(a,c,b.rounded_linear_interp)},fixed_duration:function(a,c){return b.build_func(a,c,b.interp)},fixed_duration_creator:function(a,c,d){return b.build_func(a,c,d)},fixed_duration_step:function(a,c){return b.fixed_duration_creator(a,c,b.step_interp)},fixed_duration_linear:function(a,c){return b.fixed_duration_creator(a,c,b.linear_interp)},fixed_duration_rounded_linear:function(a,c){return b.fixed_duration_creator(a,c,b.rounded_linear_interp)},"new":function(a,c,d,e){return void 0===e&&(e=b.interp),b.fixed_duration_creator(a,d,e)(c)},new_step:function(a,c,d){return b["new"](a,c,d,b.step_interp)},new_linear:function(a,c,d){return b["new"](a,c,d,b.linear_interp)},new_rounded_linear:function(a,c,d){return b["new"](a,c,d,b.rounded_linear_interp)},sequence:function(a){for(var b=a[0],c=0;c<a.length-1;c++)a[c].child=a[c+1];return[b]},new_sequence:function(a,c){for(var d=new Array(a.length),e=0;e<d.length;e++)d[e]=c(a[e]);return b.sequence(d)},get_child:function(a,b){if("last"===b)for(;void 0!==a.child;)a=a.child;else for(var c=0;b>c;c++)a=a.child;return a},update_end_value:function(a,c,d){void 0===e&&(this.transition=[]);var e=this.transition,f=b.find(a,e);f>-1?e[f].endValue=c:e.push(d(c))},check_end_value:function(a,c){var d={check:void 0,index:-1},e=this.transition;void 0===e&&(this.transition=[],e=this.transition);var f=b.find(a,e);return-1===f?d:(d.index=f,e[f].endValue===c?d.check=!0:d.check=!1,d)},duration:function(a){void 0===a&&(a=this);for(var b=a.duration,c=a;void 0!==c.child;)c=c.child,b+=c.duration;return b},find:function(a,b){if(void 0===this.transition&&(this.transition=[]),void 0===b&&(b=this.transition),0===b.length)return-1;for(var c=-1,d=0;d<b.length;d++)b[d].varName===a&&(c=d);return c},copy:function(a){if(a.constructor===Array){for(var c=new Array(a.length),d=0;d<a.length;d++)c[d]=b.copy(a[d]);return c}var c=Object.copy(a);return void 0!==c.child&&(c.child=b.copy(a.child)),void 0!==c.end&&c.end.constructor===Object&&(c.end=Object.copy(a.end)),c},loop_end:function(a){void 0===a&&(a=this);var b=a.item,c=a.transition_func;b.loop(c)},method:{add_transition:function(a,c,d){void 0===d&&(d=this),void 0===c&&(c=!0);var e=d.transition;void 0===e&&(d.transition=[],e=d.transition),e.constructor!==Array&&(e=[e]),a.constructor!==Array&&(a=[a]);for(var f=0;f<a.length;f++){a[f].item=d;var g=a[f].varName,h=b.find(g,e);-1===h?e.push(a[f]):c?e[h]=a[f]:e.push(a[f])}},add_step:function(a,c,d,e,f){void 0===f&&(f=this),void 0===e&&(e=!0);var g=b.new_step(a,c,d);return f.add_transition(g,e),f},add_linear:function(a,c,d,e,f){void 0===f&&(f=this),void 0===e&&(e=!0);var g=b.new_linear(a,c,d);return f.add_transition(g,e),f},add_rounded_linear:function(a,c,d,e,f){void 0===f&&(f=this),void 0===e&&(e=!0);var g=b.new_rounded_linear(a,c,d);return f.add_transition(g,e),f},add_power:function(a,c,d,e,f,g){void 0===g&&(g=this),void 0===f&&(f=!0);var h=b["new"](a,c,d);return h.power=e,g.add_transition(h,f),g},add_sequence:function(a,c,d){void 0===d&&(d=this);for(var e=new Array(a.length),f=0;f<e.length;f++)e[f]=c(a[f]);d.add_transition(b.sequence(e))},add_child:function(a,c,d,e,f){void 0===f&&(f=this),void 0===d&&(d=0);var g=a;if(void 0===g)return void(void 0!==f&&b.add.call(f,c));if(void 0===e)for(e=0;void 0!==g.child;)e++,g=g.child;else for(var g=a,h=0;e>h;h++)g=g.child;g.pause=d,g.child=c},add_end:function(a,c,d,e){void 0===e&&(e=this);var f=e.transition;void 0===f&&(this.transition=[],f=e.transition);var g=b.find(a,f),h=e.transition[g];c>0&&(h=b.get_child(h,c)),h.end=d},add_set:function(a,b,c,d,e,f){if(void 0===d&&(d="linear"),void 0===f&&(f=this),b.constructor===Number){for(var g=new Array(a.length),h=0;h<g.length;h++)g[h]=b;b=g}if(c.constructor===Number){for(var i=new Array(a.length),j=0;j<i.length;j++)i[j]=c;c=i}if(void 0===e||e.constructor===Number){for(var k=new Array(a.length),l=0;l<k.length;l++)k[l]=e;e=k}for(var m=0;m<a.length;m++)f["add_"+d](a[m],b[m],c[m],e[m])},loop_trans:function(a,c){void 0===c&&(c=this);var d=a(),e=b.get_child(d,"last");return void 0===e.end?e.end={item:c,transition_func:a,run:b.loop_end}:e.end.constructor===Object?e.run():e(),d},remove_transition:function(a,c){void 0===c&&(c=this);var d=c.transition;void 0===d&&(c.transition=[],d=c.transition);var e=b.find(a,d);-1!==e&&d.splice(e,1)},remove_end:function(a){void 0===a&&(a=this);var b={item:a,run:function(){void 0===this.item.remove&&(this.item.remove=$Z.core.item.remove),this.item.remove()}};return b}}},a("default",b)}}}),a.register("17",[],function(a){"use strict";var b;return{setters:[],execute:function(){b={setup:function(a,b){void 0===b&&(b=this),void 0===a&&(a={});var c={canvas:a.canvas||$Z.helper.image.create(b.width,b.height),context:a.context||$Z.helper.image.create(b.width,b.height).context(),item:a.item||[]};return b.ui=c,b}},a("default",b)}}}),a.registerDynamic("18",[],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var d=c.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();return"number"==typeof __g&&(__g=d),d.define=e,c.exports}),a.registerDynamic("19",[],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,c.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},d.define=e,c.exports}),a.registerDynamic("1a",["19"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("19");return c.exports=function(a,b,c){if(f(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},d.define=e,c.exports}),a.registerDynamic("f",["18","10","1a"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var d=a("18"),f=a("10"),g=a("1a"),h="prototype",i=function(a,b,c){var e,j,k,l=a&i.F,m=a&i.G,n=a&i.S,o=a&i.P,p=a&i.B,q=a&i.W,r=m?f:f[b]||(f[b]={}),s=m?d:n?d[b]:(d[b]||{})[h];m&&(c=b);for(e in c)j=!l&&s&&e in s,j&&e in r||(k=j?s[e]:c[e],r[e]=m&&"function"!=typeof s[e]?c[e]:p&&j?g(k,d):q&&s[e]==k?function(a){var b=function(b){return this instanceof a?new a(b):a(b)};return b[h]=a[h],b}(k):o&&"function"==typeof k?g(Function.call,k):k,o&&((r[h]||(r[h]={}))[e]=k))};return i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,c.exports=i,d.define=e,c.exports}),a.registerDynamic("1b",[],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=Object;return c.exports={create:f.create,getProto:f.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:f.getOwnPropertyDescriptor,setDesc:f.defineProperty,setDescs:f.defineProperties,getKeys:f.keys,getNames:f.getOwnPropertyNames,getSymbols:f.getOwnPropertySymbols,each:[].forEach},d.define=e,c.exports}),a.registerDynamic("1c",[],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,c.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},d.define=e,c.exports}),a.registerDynamic("13",["1c"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("1c");return c.exports=function(a){return Object(f(a))},d.define=e,c.exports}),a.registerDynamic("1d",[],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f={}.toString;return c.exports=function(a){return f.call(a).slice(8,-1)},d.define=e,c.exports}),a.registerDynamic("1e",["1d"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("1d");return c.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==f(a)?a.split(""):Object(a)},d.define=e,c.exports}),a.registerDynamic("11",[],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,c.exports=function(a){try{return!!a()}catch(b){return!0}},d.define=e,c.exports}),a.registerDynamic("1f",["1b","13","1e","11"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("1b"),g=a("13"),h=a("1e");return c.exports=a("11")(function(){var a=Object.assign,b={},c={},d=Symbol(),e="abcdefghijklmnopqrst";return b[d]=7,e.split("").forEach(function(a){c[a]=a}),7!=a({},b)[d]||Object.keys(a({},c)).join("")!=e})?function(a,b){for(var c=g(a),d=arguments,e=d.length,i=1,j=f.getKeys,k=f.getSymbols,l=f.isEnum;e>i;)for(var m,n=h(d[i++]),o=k?j(n).concat(k(n)):j(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(c[m]=n[m]);return c}:Object.assign,d.define=e,c.exports}),a.registerDynamic("20",["f","1f"],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=a("f");return f(f.S+f.F,"Object",{assign:a("1f")}),d.define=e,c.exports}),a.registerDynamic("10",[],!0,function(a,b,c){var d=this,e=d.define;d.define=void 0;var f=c.exports={version:"1.2.6"};return"number"==typeof __e&&(__e=f),d.define=e,c.exports}),a.registerDynamic("21",["20","10"],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,a("20"),c.exports=a("10").Object.assign,d.define=e,c.exports}),a.registerDynamic("3",["21"],!0,function(a,b,c){var d=this,e=d.define;return d.define=void 0,c.exports={"default":a("21"),__esModule:!0},d.define=e,c.exports}),a.register("22",["3"],function(a){var b,c;return{setters:[function(a){b=a["default"]}],execute:function(){"use strict";c={setup:function(a){function d(){p.set_position()}void 0===a&&(a={}),void 0===a.frameDurationFactor&&(a.frameDurationFactor=1),void 0===a.inputEvent&&(a.inputEvent=$Z.helper.input);var e=a.duration||17,f=document.ratio,g=a.width||480,h=a.height||640,i=Math.floor(g*f),j=Math.floor(h*f),k=a.paddingFactor||1,l=Math.floor(g*k*f),m=Math.floor(h*k*f),n=$Z.helper.image.create(g,h),o=$Z.helper.image.create(l,m),p=$Z.helper.image.create(i,j),q=o.context(),r=n.context(),s=p.context();p.place(),d();var t;a.backgroundImageUrl;void 0!==a.loadingImageUrl&&(t=$Z.helper.image.adjust_ratio($Z.helper.image.to_canvas(a.loadingImageUrl)));var u,v=a.frameDurationFactor*e,w=750,x=3*a.frameDurationFactor;u=void 0===a.opacity?1:a.opacity;var y={config:a,width:g,height:h,dur:e,frameDuration:v,fadeDuration:a.fadeDuration||w,image:t,canvas:n,context:r,fullCanvas:o,fullContext:q,screenCanvas:p,screenContext:s,xShift:Math.floor(.5*(k-1)*g),yShift:Math.floor(.5*(k-1)*h),resizeSkip:x,lastCollision:0,lastResize:0,viewportX:0,viewportY:0,viewportWidth:p.width,viewportHeight:p.height,detect:$Z.helper.action.detect,perform:$Z.helper.action.perform,image_transition:$Z.helper.transition.step_func("image",v),opacity:u,fade:$Z.helper.item.method.fade,shake:$Z.helper.effect.shake,setup_item:$Z.helper.item.setup,setup_ui:$Z.helper.ui.setup,clearSwitch:!0,input:a.inputEvent||$Z.helper.input,run:a.run||c.run,stagingArray:a.item||[],screen_callback:a.screen_callback,keyboard_callback:a.keyboard_callback,transitionSet:{x:$Z.helper.transition.rounded_linear_transition_func("viewportX",3*e),y:$Z.helper.transition.rounded_linear_transition_func("viewportY",3*e)},collision:null,collision_detect:a.collision_detect||$Z.helper.collision.pixelwise,prep:function(){$Z.iter-this.lastResize>this.resizeSkip&&(d(),this.lastResize=$Z.iter),void 0===this.item&&(this.item=[]),this.item=this.item.filter(function(a){return a.removeSwitch!==!0}),void 0!==this.ui&&(this.ui.item=this.ui.item.filter(function(a){return a.removeSwitch!==!0}));for(var a=0;a<this.stagingArray.length;a++)-1===this.item.indexOf(this.stagingArray[a])&&this.item.push(this.stagingArray[a]),void 0!==this.ui&&this.stagingArray[a].uiSwitch===!0&&-1===this.ui.item.indexOf(this.stagingArray[a])&&this.ui.item.push(this.stagingArray[a]);this.stagingArray=[],$Z.item(this.item),this.clearSwitch===!0&&this.fullContext.clearRect(0,0,this.fullCanvas.width,this.fullCanvas.height);var b=!1;return b&&(this.fullContext.globalAlpha=.75),void 0!==this.image&&this.fullContext.drawImage(this.image,0,0),!0},post:function(){var a=Math.floor((this.viewportX+this.xShift)*f),b=Math.floor((this.viewportY+this.yShift)*f),c=this.viewportWidth,d=this.viewportHeight,e=0,g=0,h=p.width,i=p.height;this.screenContext.clearRect(0,0,this.screenCanvas.width,this.screenCanvas.height),this.screenContext.globalAlpha=this.opacity,this.screenContext.drawImage(this.fullCanvas,a,b,c,d,e,g,h,i)},zoom_inout:$Z.helper.effect.zoom_inout,panX:function(a,b){var c=$Z.helper.transition.sequence(b.map(function(b){return $Z.helper.transition.rounded_linear_transition_func("viewportX",a)(b)}));this.add_transition(c[0])},panY:function(a,b){var c=$Z.helper.transition.sequence(b.map(function(b){return $Z.helper.transition.rounded_linear_transition_func("viewportY",a)(b)}));this.add_transition(c[0])},fader:function(a,b,c){return void 0===c&&(c=this),void 0===b&&(b=c.fadeDuration),a.constructor!==Array&&(a=[a]),$Z.helper.effect.image.fade_sequence({duration:b,value:a})[0]}};if(void 0!==a.item)for(var z=0;z<a.item.length;z++)a.item[z].viz=y;return b(y,$Z.helper.transition.method),b(y,$Z.helper.item.method),y.zoom=$Z.helper.effect.zoom,y},run:function(a){void 0===a&&this!==c&&(a=this),document.viz=a,document.addEventListener("mousedown",a.input.down,!1),document.addEventListener("mouseup",a.input.up,!1),document.addEventListener("touchstart",function(b){b.preventDefault(),a.input.down.call(this,b)},!1),document.addEventListener("touchend",a.input.up,!1),document.addEventListener("keydown",a.input.down,!1),document.addEventListener("keyup",a.input.up,!1),$Z.viz(a),$Z.run()},clear_cover:function(a,c){var d=$Z.helper.image.create(a.width,a.height);$Z.helper.effect.image.opacity(d,1);var e={image:d,uiSwitch:!0,addSwitch:!0};return e=b(e,c),a.setup_item(e)}},a("default",c)}}}),a.register("1",["2","4","5","6","8","9","15","16","17","22","a","b","c","d"],function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return{setters:[function(a){},function(a){b=a["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a["default"]},function(a){h=a["default"]},function(a){i=a["default"]},function(a){j=a["default"]},function(a){k=a["default"]},function(a){l=a["default"]},function(a){m=a["default"]},function(a){n=a["default"]}],execute:function(){o={action:b,audio:c,collision:d,draw:e,effect:f,image:k,input:l,item:m,loader:n,sprite:g,transition:h,ui:i,viz:j},void 0!==window.$Z&&(window.$Z.helper=o),a("default",o)}}})})(function(a){a()});
//# sourceMappingURL=vizflow-helper.js.map